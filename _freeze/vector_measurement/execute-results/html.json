{
  "hash": "e4333d3c6d0a385fe7901def16b43979",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"측정\"\nauthor: Sang-Il Lee\ndate-modified: last-modified\nnumber-sections: true\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nlightbox: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n## 폴리곤의 면적과 주변길이\n\n필수적인 패키지를 불러온다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(tmap)\nlibrary(tidyverse)\n```\n:::\n\n\n서울시의 구와 동 단위 데이터를 예제로 사용한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_gu <- st_read(\"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2023_2Q/SEOUL_GU_2023_2Q.shp\")\nseoul_dong <- st_read(\"D:/My R/Korean Administrative Areas/행정구역 셰이프 파일/2 Original Cleaning/2023_2Q/SEOUL_EMD_2023_2Q.shp\")\n```\n:::\n\n\n면적을 계산한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_area(seoul_gu)\nst_area(seoul_dong)\n```\n:::\n\n\n주변길이(perimeter)를 계산한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nst_length(st_cast(seoul_gu, \"MULTILINESTRING\"))\nst_area(seoul_dong)\n```\n:::\n\n\n## 폴리곤의 형태\n\n콤펙트비(compactness ratio)를 다음의 수식에 의거해 계산한다.\n\n$$\nS_1=A/(P^2/4\\pi)=4\\pi A/P^2\n$$\n\n$$\nS_2=(2\\pi \\sqrt{A/\\pi})/P=2\\sqrt{\\pi A}/P=3.545\\sqrt{A}/P\n$$\n\n함수를 작성한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsnu_poly_shape_index <- function(poly.shp){\n  A <- st_area(poly.shp)\n  P <- st_length(st_cast(poly.shp, \"MULTILINESTRING\"))\n  S.1 <- 4*pi*A/P^2\n  S.2 <- sqrt(S.1)\n  poly.shp$S1 <- as.numeric(S.1)\n  poly.shp$S2 <- as.numeric(S.2)\n  poly.shp\n}\n```\n:::\n\n\n서울시 구의 콤펙트비를 계산한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_gu <- snu_poly_shape_index(seoul_gu)\nseoul_gu |> slice_max(S1) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 11 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 961989.7 ymin: 1952338 xmax: 966325.5 ymax: 1958028\nProjected CRS: KGD2002 / Unified CS\n  SGG1_CD SD_CD      SD_NM SG1_CD     SG1_NM SGG1_NM          SGG1_FNM\n1   11070    11 서울특별시     11 서울특별시  중랑구 서울특별시 중랑구\n       Eng_NM Chn_NM        S1        S2                       geometry\n1 Jungnang-gu 中浪區 0.6725585 0.8200967 POLYGON ((964125.5 1952433,...\n```\n\n\n:::\n\n```{.r .cell-code}\nseoul_gu |> slice_min(S1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 11 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 939273.8 ymin: 1941770 xmax: 947237.7 ymax: 1946700\nProjected CRS: KGD2002 / Unified CS\n  SGG1_CD SD_CD      SD_NM SG1_CD     SG1_NM SGG1_NM          SGG1_FNM  Eng_NM\n1   11170    11 서울특별시     11 서울특별시  구로구 서울특별시 구로구 Guro-gu\n  Chn_NM        S1        S2                       geometry\n1 九老區 0.2072557 0.4552534 POLYGON ((940771.4 1942203,...\n```\n\n\n:::\n:::\n\n\n서울시 동의 콤펙트비를 계산한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseoul_dong <- snu_poly_shape_index(seoul_dong)\nseoul_dong |> slice_max(S1) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 17 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 964999.1 ymin: 1944822 xmax: 966120.8 ymax: 1945928\nProjected CRS: KGD2002 / Unified CS\n    EMD_ID SD_CD      SD_NM SG1_CD     SG1_NM SG2_CD     SG2_NM SGG1_CD SGG1_NM\n1 11240610    11 서울특별시     11 서울특별시     11 서울특별시   11240  송파구\n  SGG2_CD SGG2_NM EMD_NM_y                   EMD_FNM            Eng_NM  Chn_NM\n1   11240  송파구  송파1동 서울특별시 송파구 송파1동 Songpa 1(il)-dong 松坡1洞\n         S1        S2                       geometry\n1 0.8282855 0.9101019 POLYGON ((965536.1 1944822,...\n```\n\n\n:::\n\n```{.r .cell-code}\nseoul_dong |> slice_min(S1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSimple feature collection with 1 feature and 17 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 959962.2 ymin: 1949952 xmax: 962352.3 ymax: 1951280\nProjected CRS: KGD2002 / Unified CS\n    EMD_ID SD_CD      SD_NM SG1_CD     SG1_NM SG2_CD     SG2_NM SGG1_CD SGG1_NM\n1 11040690    11 서울특별시     11 서울특별시     11 서울특별시   11040  성동구\n  SGG2_CD SGG2_NM EMD_NM_y                  EMD_FNM         Eng_NM Chn_NM\n1   11040  성동구   송정동 서울특별시 성동구 송정동 Songjeong-dong 松亭洞\n         S1        S2                       geometry\n1 0.2043469 0.4520475 POLYGON ((961792.8 1949976,...\n```\n\n\n:::\n:::\n\n\n서울시 구의 콤펙트비 지도를 제작한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmin.val <- seoul_gu |> pull(S1) |> min() |> format(digits = 3)\nmax.val <- seoul_gu |> pull(S1) |> max() |> format(digits = 3)\nmy_map <- tm_shape(seoul_gu) + \n  tm_polygons(\n    col = \"S1\", \n    palette = \"BuPu\", \n    style = \"fixed\", \n    breaks = c(0, 0.3, 0.4, 0.5, 0.6, 1),\n    labels = c(paste0(\"< 0.3\", \" (Min. \", min.val, \")\"), \"0.3 ~ 0.4\", \"0.4 ~ 0.5\", \"0.5 ~ 0.6\", paste0(\">= 0.6\", \" (Max. \", max.val, \")\")),     title = \"Compactness\", legend.show = TRUE) +\n  tm_legend(legend.position = c(0.81, 0.03)) + \n  tm_layout(inner.margins = c(0.06, 0.04, 0.04, 0.13)) + \n  tm_scale_bar(breaks = seq(0, 20, 4), color.dark = \"gray60\", position = c(0.03, 0.01))\nmy_map \n```\n\n::: {.cell-output-display}\n![](vector_measurement_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n서울시 동의 콤펙트비 지도를 제작한다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmin.val <- seoul_dong |> pull(S1) |> min() |> format(digits = 3)\nmax.val <- seoul_dong |> pull(S1) |> max() |> format(digits = 3)\nmy_map <- tm_shape(seoul_dong) + \n  tm_polygons(\n    col = \"S1\", \n    palette = \"BuPu\", \n    style = \"fixed\", \n    breaks = c(0, 0.3, 0.4, 0.5, 0.6, 1),\n    labels = c(paste0(\"< 0.3\", \" (Min. \", min.val, \")\"), \"0.3 ~ 0.4\", \"0.4 ~ 0.5\", \"0.5 ~ 0.6\", paste0(\">= 0.6\", \" (Max. \", max.val, \")\")),     title = \"Compactness\", legend.show = TRUE) +\n  tm_shape(seoul_gu) + tm_borders(col = \"gray20\", lwd = 2) +\n  tm_legend(legend.position = c(0.81, 0.03)) + \n  tm_layout(inner.margins = c(0.06, 0.04, 0.04, 0.13)) + \n  tm_scale_bar(breaks = seq(0, 20, 4), color.dark = \"gray60\", position = c(0.03, 0.01))\nmy_map \n```\n\n::: {.cell-output-display}\n![](vector_measurement_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "vector_measurement_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}